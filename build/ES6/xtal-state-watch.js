(function(){const a='xtal-state-watch';if(customElements.get(a))return;const b='watch',c=[],d=history.pushState,e=d.bind(history);history.pushState=function(a,b,d){e(a,b,d),c.forEach((b)=>{b.history=a})};const f=history.replaceState,g=f.bind(history);history.replaceState=function(a,b,d){g(a,b,d),c.forEach((b)=>{b.history=a})},window.addEventListener('popstate',()=>{c.forEach((a)=>{a.history=history.state})});class h extends HTMLElement{get history(){return window.history.state}set history(a){this.watch&&this.notify(a)}get watch(){return this._watch}set watch(a){a?this.setAttribute(b,''):this.removeAttribute(b)}notify(a){a||(a=history.state);const b=new CustomEvent('history-changed',{detail:{value:window.history.state},bubbles:!0,composed:!1});this.dispatchEvent(b)}_upgradeProperty(a){if(this.hasOwnProperty(a)){let b=this[a];delete this[a],this[a]=b}}attributeChangedCallback(a,c,d){a===b?(this._watch=null!==d,this._watch&&this.notify()):void 0}connectedCallback(){this._upgradeProperty('watch')}}customElements.define(a,h)})();