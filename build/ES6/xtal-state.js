(function(){const a='set-state-and-push',b='set-state-and-replace',c='history-state-changed';class d extends HTMLElement{get historyState(){return window.history.state}set historyState(a){this.broadastHistoryChange(a,!1)}broadastHistoryChange(a,b){const d=new CustomEvent(c,{detail:{value:a,fromPopEvent:b},bubbles:!0,composed:!0});this.dispatchEvent(d)}get setStateAndPush(){return this._push}set setStateAndPush(b){b?this.setAttribute(a,''):this.removeAttribute(a)}get setStateAndReplace(){return this._replace}set setStateAndReplace(a){a?this.setAttribute(b,''):this.removeAttribute(b)}get source(){return this._source}set source(a){this._source=a,this.onPropsChange()}onPropsChange(){if(!this._push&&!this._replace)return;if(!this.source)return;let a;switch(typeof this.source){case'object':a=window.history.state?Object.assign({},window.history.state):{},Object.assign(a,this.source);break;case'string':case'number':a=this.source;}this._push?window.history.pushState(a,''):window.history.replaceState(a,''),this.historyState=a}static get observedAttributes(){return[a,b]}attributeChangedCallback(c,d,e){c===a?this._push=null!==e:c===b?this._replace=null!==e:void 0;this.onPropsChange()}_upgradeProperty(a){if(this.hasOwnProperty(a)){let b=this[a];delete this[a],this[a]=b}}connectedCallback(){this._upgradeProperty('setStateAndPush'),this._upgradeProperty('setStateAndReplace');const a=this;window.addEventListener('popstate',()=>{a.broadastHistoryChange(a.historyState,!0)}),this.addEventListener(c,this.updateState),this.historyState=window.history.state}disconnectedCallback(){window.removeEventListener('popstate',this.updateState)}updateState(a){a.type===c&&this===a.target||a.detail&&a.detail.fromPopEvent||(this.historyState=window.history.state)}}customElements.define('xtal-state',d)})();